#!/usr/bin/env node
"use strict";

let start = require("../lib/index");
let parseArgs = require("minimist");

let HELP = `
Usage:
  $ faucet [options]

Options:
  -h, --help
    display this help message
  -c, --config
    configuration file (defaults to \`faucet.config.js\`)
  -w, --watch
    monitor the file system for changes to recompile automatically
  --fingerprint
    add fingerprint hash to file names
  --compact
    reduce output size (e.g. via minification)
`.trim();

let argv = parseArgs(process.argv.slice(2), {
	alias: {
		c: "config",
		w: "watch",
		h: "help"
	}
});

if(argv.help) {
	console.log(HELP); // eslint-disable-line no-console
	process.exit();
}

let options = ["watch", "fingerprint", "compact"].reduce((memo, option) => {
	let value = argv[option];
	if(value !== undefined) {
		memo[option] = value;
	}
	return memo;
}, {});

start(process.cwd(), argv.config, options);
